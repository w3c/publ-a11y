<!DOCTYPE html><html lang="en-US"><head>
<meta charset="utf-8">
<meta name="generator" content="ReSpec 35.2.2">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
		
		
<title>Display Techniques for EPUB Accessibility Metadata 2.0</title>
		
		
		
		  
<style>

	  	var {
			color: brown;
		}
	  	ol.condition > li {
	  		margin-top: 1rem;
	  		margin-left: 0;
	  		padding-left: 0;
	  	}
	  	ol.condition > li > span {
	  		display: block;
	  	}
	  	ol.condition > li > span:nth-child(n+2) {
	  		margin-left: 2rem;
	  	}
	  	code.xpath {
	  		word-break: keep-all;
	  	}
	  	span.str-id {
			background: #faa;
			border-radius: 3px;
			font: normal normal 400 1em/1.2 monospace;
			margin-left: 0.5em;
			padding: 0.1em;
			display: inline !important;
	  	}
	  
</style>
	
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
<meta name="color-scheme" content="light">
<link rel="canonical" href="https://www.w3.org/publishing/a11y/UX-Guide-metadata/techniques/epub-metadata/">
<style>
.hljs{--base:#fafafa;--mono-1:#383a42;--mono-2:#686b77;--mono-3:#717277;--hue-1:#0b76c5;--hue-2:#336ae3;--hue-3:#a626a4;--hue-4:#42803c;--hue-5:#ca4706;--hue-5-2:#c91243;--hue-6:#986801;--hue-6-2:#9a6a01}
@media (prefers-color-scheme:dark){
.hljs{--base:#282c34;--mono-1:#abb2bf;--mono-2:#818896;--mono-3:#5c6370;--hue-1:#56b6c2;--hue-2:#61aeee;--hue-3:#c678dd;--hue-4:#98c379;--hue-5:#e06c75;--hue-5-2:#be5046;--hue-6:#d19a66;--hue-6-2:#e6c07b}
}
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;color:var(--mono-1,#383a42);background:#fafafa;background:var(--base,#fafafa)}
.hljs-comment,.hljs-quote{color:#717277;color:var(--mono-3,#717277);font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4;color:var(--hue-3,#a626a4)}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;color:var(--hue-5,#ca4706);font-weight:700}
.hljs-literal{color:#0b76c5;color:var(--hue-1,#0b76c5)}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c;color:var(--hue-4,#42803c)}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01;color:var(--hue-6-2,#9a6a01)}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801;color:var(--hue-6,#986801)}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3;color:var(--hue-2,#336ae3)}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "group": "publishingcg",
  "specStatus": "CG-DRAFT",
  "noRecTrack": true,
  "latestVersion": "https://www.w3.org/publishing/a11y/UX-Guide-metadata/techniques/epub-metadata/",
  "edDraftURI": "https://w3c.github.io/publ-a11y/a11y-meta-display-guide/2.0/draft/techniques/epub-metadata/",
  "canonicalURI": "https://www.w3.org/publishing/a11y/UX-Guide-metadata/techniques/epub-metadata/",
  "editors": [
    {
      "name": "Charles LaPierre",
      "company": "Benetech",
      "companyURL": "http://www.benetech.org",
      "w3cid": 72055
    }
  ],
  "processVersion": 2020,
  "includePermalinks": false,
  "permalinkEdge": true,
  "permalinkHide": false,
  "diffTool": "http://www.aptest.com/standards/htmldiff/htmldiff.pl",
  "github": {
    "repoURL": "https://github.com/w3c/publ-a11y/",
    "branch": "main"
  },
  "preProcess": [
    null
  ],
  "publishDate": "2025-02-20",
  "thisVersion": "https://w3c.github.io/publ-a11y/a11y-meta-display-guide/2.0/techniques/epub-metadata/epub-metadata-draft-note-20250220.html",
  "publishISODate": "2025-02-20T00:00:00.000Z",
  "generatedSubtitle": "Draft Community Group Report 20 February 2025"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/cg-draft"></head>
	<body class="h-entry informative"><div class="head">
    
    <h1 id="title" class="title">Display Techniques for EPUB Accessibility Metadata 2.0</h1> 
    <p id="w3c-state">
      <a href="https://www.w3.org/standards/types#reports">Draft Community Group Report</a>
      <time class="dt-published" datetime="2025-02-20">20 February 2025</time>
    </p>
    <dl>
      <dt>This version:</dt><dd>
              <a class="u-url" href="https://w3c.github.io/publ-a11y/a11y-meta-display-guide/2.0/techniques/epub-metadata/epub-metadata-draft-note-20250220.html">https://w3c.github.io/publ-a11y/a11y-meta-display-guide/2.0/techniques/epub-metadata/epub-metadata-draft-note-20250220.html</a>
            </dd>
      <dt>Latest published version:</dt><dd>
              <a href="https://www.w3.org/publishing/a11y/UX-Guide-metadata/techniques/epub-metadata/">https://www.w3.org/publishing/a11y/UX-Guide-metadata/techniques/epub-metadata/</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/publ-a11y/a11y-meta-display-guide/2.0/draft/techniques/epub-metadata/">https://w3c.github.io/publ-a11y/a11y-meta-display-guide/2.0/draft/techniques/epub-metadata/</a></dd>
      
      
      
      
      <dt>Editor:</dt><dd class="editor p-author h-card vcard" data-editor-id="72055">
    <span class="p-name fn">Charles LaPierre</span> (<a class="p-org org h-org" href="http://www.benetech.org">Benetech</a>)
  </dd>
      
      
      <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/publ-a11y/">GitHub w3c/publ-a11y</a>
        (<a href="https://github.com/w3c/publ-a11y/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/publ-a11y/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/publ-a11y/issues/">open issues</a>)
      </dd>
      
    </dl>
    
    <p class="copyright">
          <a href="https://www.w3.org/policies/#copyright">Copyright</a>
          ©
          2025
          
          the Contributors to the Display Techniques for EPUB Accessibility Metadata 2.0
          Specification, published by the
          <a href="https://www.w3.org/groups/cg/publishingcg">Publishing Community Group</a> under the
          <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>. A human-readable
                <a href="https://www.w3.org/community/about/agreements/cla-deed/">summary</a>
                is available.
              
        </p>
    <hr title="Separator for header">
  </div>
		<section id="abstract" class="introductory"><h2>Abstract</h2></section>
        <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This specification was published by the
      <a href="https://www.w3.org/groups/cg/publishingcg">Publishing Community Group</a>. It is not a W3C Standard nor is it
      on the W3C Standards Track.
      
            Please note that under the
            <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>
            there is a limited opt-out and other conditions apply.
          
      Learn more about
      <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>.
    </p><p>
    <a href="https://github.com/w3c/publ-a11y/issues/">GitHub Issues</a> are preferred for
          discussion of this specification.
        
    
  </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#epub-accessibility-metadata"><bdi class="secno">1.1 </bdi>EPUB Accessibility Metadata</a></li><li class="tocline"><a class="tocxref" href="#conventions"><bdi class="secno">1.2 </bdi>Conventions for Implementations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#heading-structure"><bdi class="secno">1.2.1 </bdi>Heading Structure</a></li><li class="tocline"><a class="tocxref" href="#coding-conventions"><bdi class="secno">1.2.2 </bdi>Coding Conventions</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#common-functions"><bdi class="secno">2. </bdi>Common Functions</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#pre-processing"><bdi class="secno">2.1 </bdi>Preprocessing</a></li><li class="tocline"><a class="tocxref" href="#check-for-node"><bdi class="secno">2.2 </bdi>Check for Node</a></li></ol></li><li class="tocline"><a class="tocxref" href="#techniques"><bdi class="secno">3. </bdi>Techniques</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ways-of-reading"><bdi class="secno">3.1 </bdi>Ways of reading</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#visual-adjustments"><bdi class="secno">3.1.1 </bdi>Visual adjustments</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables"><bdi class="secno">3.1.1.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup"><bdi class="secno">3.1.1.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#instructions"><bdi class="secno">3.1.1.3 </bdi>Instructions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#supports-nonvisual-reading"><bdi class="secno">3.1.2 </bdi>Supports nonvisual reading</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables-0"><bdi class="secno">3.1.2.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup-0"><bdi class="secno">3.1.2.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#instructions-0"><bdi class="secno">3.1.2.3 </bdi>Instructions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#prerecorded-audio"><bdi class="secno">3.1.3 </bdi>Prerecorded audio</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables-1"><bdi class="secno">3.1.3.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup-1"><bdi class="secno">3.1.3.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#instructions-1"><bdi class="secno">3.1.3.3 </bdi>Instructions</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#conformance-group"><bdi class="secno">3.2 </bdi>Conformance</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables-2"><bdi class="secno">3.2.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup-2"><bdi class="secno">3.2.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#conformance-instructions"><bdi class="secno">3.2.3 </bdi>Instructions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#navigation"><bdi class="secno">3.3 </bdi>Navigation</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables-3"><bdi class="secno">3.3.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup-3"><bdi class="secno">3.3.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#navigation-instructions"><bdi class="secno">3.3.3 </bdi>Instructions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#rich-content"><bdi class="secno">3.4 </bdi>Rich content</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables-4"><bdi class="secno">3.4.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup-4"><bdi class="secno">3.4.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#rich-content-instructions"><bdi class="secno">3.4.3 </bdi>Instructions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#hazards"><bdi class="secno">3.5 </bdi>Hazards</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables-5"><bdi class="secno">3.5.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup-5"><bdi class="secno">3.5.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#hazards-instructions"><bdi class="secno">3.5.3 </bdi>Instructions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#accessibility-summary"><bdi class="secno">3.6 </bdi>Accessibility summary</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables-6"><bdi class="secno">3.6.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup-6"><bdi class="secno">3.6.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#accessibility-summary-instructions"><bdi class="secno">3.6.3 </bdi>Instructions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#legal-considerations"><bdi class="secno">3.7 </bdi>Legal considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables-7"><bdi class="secno">3.7.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup-7"><bdi class="secno">3.7.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#legal-considerations-instructions"><bdi class="secno">3.7.3 </bdi>Instructions</a></li></ol></li><li class="tocline"><a class="tocxref" href="#additional-accessibility-information"><bdi class="secno">3.8 </bdi>Additional accessibility information</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#understanding-the-variables-8"><bdi class="secno">3.8.1 </bdi>Understanding the variables</a></li><li class="tocline"><a class="tocxref" href="#variables-setup-8"><bdi class="secno">3.8.2 </bdi>Variables setup</a></li><li class="tocline"><a class="tocxref" href="#additional-accessibility-information-instructions"><bdi class="secno">3.8.3 </bdi>Instructions</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">A. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">B. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">B.1 </bdi>Informative references</a></li></ol></li></ol></nav>
        <section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
            
            <section id="epub-accessibility-metadata"><div class="header-wrapper"><h3 id="x1-1-epub-accessibility-metadata"><bdi class="secno">1.1 </bdi>EPUB Accessibility Metadata</h3><a class="self-link" href="#epub-accessibility-metadata" aria-label="Permalink for Section 1.1"></a></div>

            <p>This metadata as outlined in EPUB Accessibility 1.1 [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-a11y-11" title="EPUB Accessibility 1.1">epub-a11y-11</a></cite>], can be found in the EPUB package document [<cite><a class="bibref" data-link-type="biblio" href="#bib-epub-33" title="EPUB 3.3">EPUB-33</a></cite>].</p>

            <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="3"><span>Note</span></div><aside class="">
                Techniques for displaying accessibility metadata in other metadata formats can be found in the <a href="../../guidelines/#techniques">Display Techniques for Displaying Accessibility Metadata</a>
            </aside></div>

 			<div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="3"><span>Note</span></div><aside class="">
 				This document provides techniques for meeting the guidelines of the <a href="../../guidelines/">Accessibility Metadata Display Guide for Digital Publications 2.0</a>. It provides practical examples for extracting information from the ONIX metadata for showing it to the end users.
			 </aside></div>

			<div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="3"><span>Note</span></div><aside class="">
 			    The examples provided in this document demonstrate the "compact" version of what is to be displayed.
                For every text string both the "compact" or the "descriptive" options are available.

                <aside class="example" id="example-compact-versus-descriptive"><div class="marker">
    <a class="self-link" href="#example-compact-versus-descriptive">Example<bdi> 1</bdi></a><span class="example-title">: Compact Versus Descriptive</span>
  </div>
                    <pre><code aria-busy="false" class="hljs json">
    <span class="hljs-attr">"visual-adjustments"</span><span class="hljs-punctuation">:</span>
        <span class="hljs-punctuation">{</span>
        <span class="hljs-attr">"visual-adjustments-title"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Visual adjustments"</span><span class="hljs-punctuation">,</span>
        <span class="hljs-attr">"visual-adjustments-modifiable"</span><span class="hljs-punctuation">:</span>
            <span class="hljs-punctuation">{</span>
            <span class="hljs-attr">"descriptive"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Appearance of the text and page layout can be modified according to the capabilities of the reading system (font family and font size, spaces between paragraphs, sentences, words, and letters, as well as color of background and text)"</span><span class="hljs-punctuation">,</span>
            <span class="hljs-attr">"compact"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Appearance can be modified"</span>
            <span class="hljs-punctuation">}</span>
        <span class="hljs-punctuation">}</span>
</code></pre>
                </aside>

                The option is yours to provide either the "compact" or "descriptive" versions to the end user or perhaps even allow the user to choose what they wish to see.

                <div class="note" id="issue-container-generatedID-2"><div role="heading" class="ednote-title marker" id="h-ednote" aria-level="3"><span>Editor's note</span></div><aside class="">
                    Link to the English JSON file where this example is taken from.
                </aside></div>
			 </aside></div>

		</section><section id="conventions"><div class="header-wrapper"><h3 id="x1-2-conventions-for-implementations"><bdi class="secno">1.2 </bdi>Conventions for Implementations</h3><a class="self-link" href="#conventions" aria-label="Permalink for Section 1.2"></a></div>
			
            
            <section id="heading-structure"><div class="header-wrapper"><h4 id="x1-2-1-heading-structure"><bdi class="secno">1.2.1 </bdi>Heading Structure</h4><a class="self-link" href="#heading-structure" aria-label="Permalink for Section 1.2.1"></a></div>
                <p>The algorithms defined in this document do not include instructions for outputting their respective headings because if a given technique does not result in any information (i.e., would output a statement that no information is available), the section may be omitted (i.e., no heading would be displayed). Whether there is any information to display is only known after an algorithm is processed, which would lead to the algorithms having to include instructions to remove headings.</p>
            
                <p>The headings structure to use for the techniques is defined in the guidelines but is repeated here to help guide implementations. The headings are linked to the algorithm they are associated with.</p>

                <ol>
                    <li><code id="ways-of-reading-title">"<a href="#ways-of-reading">Ways of reading</a>"</code><span class="str-id">[ID: ways-of-reading-title]</span></li>
                    <li><code id="conformance-title">"<a href="#conformance-instructions">Conformance</a>"</code><span class="str-id">[ID: conformance-title]</span></li>
                    <li><code id="navigation-title">"<a href="#navigation-instructions">Navigation</a>"</code><span class="str-id">[ID: navigation-title]</span></li>
                    <li><code id="rich-content-title">"<a href="#rich-content-instructions">Rich content</a>"</code><span class="str-id">[ID: rich-content-title]</span></li>
                    <li><code id="hazards-title">"<a href="#hazards-instructions">Hazards</a>"</code><span class="str-id">[ID: hazards-title]</span></li>
                    <li><code id="accessibility-summary-title">"<a href="#accessibility-summary-instructions">Accessibility summary</a>"</code><span class="str-id">[ID: accessibility-summary-title]</span></li>
                    <li><code id="legal-considerations-title">"<a href="#legal-considerations-instructions">Legal considerations</a>"</code><span class="str-id">[ID: legal-considerations-title]</span></li>
                    <li><code id="additional-accessibility-information-title">"<a href="#additional-accessibility-information">Additional accessibility information</a>"</code><span class="str-id">[ID: additional-accessibility-information-title]</span></li>
                </ol>
            
            </section><section id="coding-conventions"><div class="header-wrapper"><h4 id="x1-2-2-coding-conventions"><bdi class="secno">1.2.2 </bdi>Coding Conventions</h4><a class="self-link" href="#coding-conventions" aria-label="Permalink for Section 1.2.2"></a></div>
			<p>The code conventions used in the provided code snippet follow a structure commonly found in programming languages like Python, Java, or C++. Here's an explanation of the conventions:</p>
			<dl>
				<dt>Conditionals and Control Flow:</dt>
					<dd><b>IF</b>, <b>ELSE IF</b>, and <b>ELSE</b> (in bold and capital letters) statements are used to define different conditions and the corresponding actions to be taken.</dd>
				<dt>Operators:</dt>
					<dd>Written operators (<i>is present</i>) are used to check if a particular code or codelist is present (or not) in the metadata record.</dd>
				<dt>Logical operators:</dt>
					<dd>Logical operators (<b>AND</b>, <b>OR</b>, <b>NOT</b>, in bold and capital letters) are used to combine conditions.</dd>
				<dt>String Literals:</dt>
					<dd>String literals are used to represent the text that should be displayed when a particular condition is met.</dd>
				<dt>Variable Naming:</dt>
					<dd>The terms like "property" and "value" are used in a way that suggests a variable or data structure representing the metadata record.</dd>
				<dt>Indentation:</dt>
					<dd>The code uses consistent indentation to define blocks of code within conditional statements. This is crucial for readability and maintaining a clear structure.</dd>
				<dt>Readability:</dt>
					<dd>The code is written in a way that is intended to be easily readable and understandable even by non-coders.</dd>
			</dl>
		  </section></section>
        </section>
		<section id="common-functions"><div class="header-wrapper"><h2 id="x2-common-functions"><bdi class="secno">2. </bdi>Common Functions</h2><a class="self-link" href="#common-functions" aria-label="Permalink for Section 2."></a></div>
			
			<p>In this section we define the functions common to all techniques, which are called by them during execution.</p>

            <section id="pre-processing"><div class="header-wrapper"><h3 id="x2-1-preprocessing"><bdi class="secno">2.1 </bdi>Preprocessing</h3><a class="self-link" href="#pre-processing" aria-label="Permalink for Section 2.1"></a></div>
				
				<p>Before working directly with the metadata we must read the metadata in the Package document (package document) inside the EPUB. This is a common starting point for all techniques that allows us to query the metadata directly.</p>

				<div class="note" role="note" id="issue-container-generatedID-3"><div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span>Note</span></div><aside class="">
					<p>This algorithm does not describe how the Package document is discovered and extracted within an EPUB.</p>
				</aside></div>

				<p>This algorithm takes the <var>package_document_as_text</var> argument: a UTF-8 string representing the Package document.</p>
				<p>To generate the internal representation, run the following steps:</p>
				<ol class="condition">
					<li><b>LET</b> <var>package_document</var> be the DOM tree that results from parsing <var>package_document_as_text</var> using an XML DOM parser.</li>
					<li>Return <var>package_document</var>.</li>
				</ol>
			</section>

     		<section id="check-for-node"><div class="header-wrapper"><h3 id="x2-2-check-for-node"><bdi class="secno">2.2 </bdi>Check for Node</h3><a class="self-link" href="#check-for-node" aria-label="Permalink for Section 2.2"></a></div>
				
				<p>Many of the techniques rely on checking for the presence or absence of metadata in the metadata section of the Package document.</p>

                <div class="note" role="note" id="issue-container-generatedID-4"><div role="heading" class="note-title marker" id="h-note-3" aria-level="4"><span>Note</span></div><aside class="">
                    <p>All XPATHs are made for EPUB 3, while for EPUB 2 they would need to be adjusted.</p>
                </aside></div>

				<p>This algorithm takes:</p>
				<ul>
					<li>the <var>package_document</var> argument: the internal representation of the Package document (output of <a href="#pre-processing">preprocessing</a>);</li>
					<li>the <var>path</var> argument: the XPATH of the node to check the presence of.</li>
				</ul>
				<p>To check for node, run the following steps:</p>
				<ol class="condition">
					<li>
						<span><b>IF</b> <var>package_document</var> contains <var>path</var>:</span>
						<span><b>THEN</b> return <code>True</code>.</span>
					</li>
					<li><b>ELSE</b> return <code>False</code>.</li>
				</ol>
			</section>
        </section>

		<section id="techniques"><div class="header-wrapper"><h2 id="x3-techniques"><bdi class="secno">3. </bdi>Techniques</h2><a class="self-link" href="#techniques" aria-label="Permalink for Section 3."></a></div>
			

            <section id="ways-of-reading"><div class="header-wrapper"><h3 id="x3-1-ways-of-reading"><bdi class="secno">3.1 </bdi>Ways of reading</h3><a class="self-link" href="#ways-of-reading" aria-label="Permalink for Section 3.1"></a></div>
                

                <p>This technique relates to the <a href="../../guidelines/#ways-of-reading">Ways of reading accessibility display field</a>.</p>
  
                <p>This algorithm takes the <var>package_document_as_text</var> argument: a UTF-8 string representing the Package document.</p>


                <section id="visual-adjustments"><div class="header-wrapper"><h4 id="x3-1-1-visual-adjustments"><bdi class="secno">3.1.1 </bdi>Visual adjustments</h4><a class="self-link" href="#visual-adjustments" aria-label="Permalink for Section 3.1.1"></a></div>
                    
                    
                    <p>This technique relates to the <a href="../../guidelines/#visual-adjustments">Visual adjustments accessibility display field</a>.</p>
  
                    <section id="understanding-the-variables"><div class="header-wrapper"><h5 id="x3-1-1-1-understanding-the-variables"><bdi class="secno">3.1.1.1 </bdi>Understanding the variables</h5><a class="self-link" href="#understanding-the-variables" aria-label="Permalink for Section 3.1.1.1"></a></div>
                    <dl>
                        <dt><var>all_textual_content_can_be_modified</var></dt>
                        <dd>
                            <p>If true it indicates that the <i>accessibilityFeature="displayTransformability"</i> (All textual content can be modified) is present in the package document, otherwise if false it means that the metadata is not present.</p>
                            <p><i>All textual content can be modified</i> means that the digital publication does not restrict the ability of users to modify and reflow the display of any textual content to the full extent allowed by the reading system (i.e. to change the text size or typeface, line height and word spacing, colors).</p>
                        </dd>
                        <dt><var>is_fixed_layout</var></dt>
                        <dd>
                            <p>If true it indicates that the <i>layout="pre-paginated"</i> (Fixed format) is present in the package document, otherwise if false it means that the metadata is not present.</p>
                            <p><i>Fixed format</i> means that digital publication is in fixed format (e.g. EPUB Fixed Layout).</p>
                        </dd>
                    </dl>

                    </section><section id="variables-setup"><div class="header-wrapper"><h5 id="x3-1-1-2-variables-setup"><bdi class="secno">3.1.1.2 </bdi>Variables setup</h5><a class="self-link" href="#variables-setup" aria-label="Permalink for Section 3.1.1.2"></a></div>
                    <ol class="condition">
                        <li><b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.</li>

                        <li><b>LET</b> <var>all_textual_content_can_be_modified</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>displayTransformability</i>"]</code>.</li>

                        <li><b>LET</b> <var>is_fixed_layout</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="rendition:<i>layout</i>" and normalize-space()="<i>pre-paginated</i>"]</code>.</li>

                    </ol>
                    </section><section id="instructions"><div class="header-wrapper"><h5 id="x3-1-1-3-instructions"><bdi class="secno">3.1.1.3 </bdi>Instructions</h5><a class="self-link" href="#instructions" aria-label="Permalink for Section 3.1.1.3"></a></div>
                    <ol class="condition">
                        <li>
                            <span><b>IF</b> <var>all_textual_content_can_be_modified</var>:</span>
                            <span><b>THEN</b> display <code id="ways-of-reading-visual-adjustments-modifiable">"Appearance can be modified"</code><span class="str-id">[ID: ways-of-reading-visual-adjustments-modifiable]</span>.</span>
                        </li>
                        <li>
                            <span><b>ELSE IF</b> <var>is_fixed_layout</var>:</span>
                            <span><b>THEN</b> display <code id="ways-of-reading-visual-adjustments-unmodifiable">"Appearance cannot be modified"</code><span class="str-id">[ID: ways-of-reading-visual-adjustments-unmodifiable]</span>.</span>
                        </li>
                        <li><b>ELSE</b> display <code id="ways-of-reading-visual-adjustments-unknown">"No information  about appearance modifiability is available"</code><span class="str-id">[ID: ways-of-reading-visual-adjustments-unknown]</span>.</li>
                    </ol>
                </section></section>

                <section id="supports-nonvisual-reading"><div class="header-wrapper"><h4 id="x3-1-2-supports-nonvisual-reading"><bdi class="secno">3.1.2 </bdi>Supports nonvisual reading</h4><a class="self-link" href="#supports-nonvisual-reading" aria-label="Permalink for Section 3.1.2"></a></div>
                    
                    <p>This technique relates to the <a href="../../guidelines/#supports-nonvisual-reading">Supports nonvisual reading accessibility display field</a>.</p>

                    <section id="understanding-the-variables-0"><div class="header-wrapper"><h5 id="x3-1-2-1-understanding-the-variables"><bdi class="secno">3.1.2.1 </bdi>Understanding the variables</h5><a class="self-link" href="#understanding-the-variables-0" aria-label="Permalink for Section 3.1.2.1"></a></div>
                    <dl>
                        <dt><var>all_necessary_content_textual</var></dt>
                        <dd>
                            <p>If true it indicates that there is only a single access mode of textual or <i>accessModeSufficient="textual"</i> (all main content is provided in textual form) is present in the package document.</p>
                        </dd>
                    	<dt><var>audio_only_content</var></dt>
                    	<dd>
                    		<p>If true it indicates that there is only a single access mode of auditory (an audiobook).</p>
                    	</dd>
                    	<dt><var>some_sufficient_text</var></dt>
                        <dd>
                            <p>If true it indicates that sufficient access mode metadata indicates that the content is at least partially
                            	readable in textual form (i.e., "textual" is one of a set of sufficient access modes).</p>
                        </dd>
                        <dt><var>textual_alternatives</var></dt>
                        <dd>
                            <p>If true it indicates that at least one of the following is present in the package document:</p>
                            <ul>
                                <li><i>accessibilityFeature="alternativeText"</i> (Short alternative textual descriptions);</li>
                                <li><i>accessibilityFeature="longDescription"</i> (Full alternative textual descriptions);</li>
                                <li><i>accessibilityFeature="describedMath"</i> (Visual of math fully described));</li>
                            	<li><i>accessibilityFeature="transcript"</i> (Transcripts for audio and visual content);</li>
                            	<li>otherwise if false it means that this metadata is not present.</li>
                            </ul>
                            <p>This means that there are textual alternatives for the non-textual content.</p>
                        </dd>
                    	<dt><var>visual_only_content</var></dt>
                    	<dd>
                    		<p>If true it indicates that there is only a single access mode of visual and there are no sufficient access modes that include textual (e.g., comics and manga with no alternative text).</p>
                    	</dd>
                    </dl>
                    </section><section id="variables-setup-0"><div class="header-wrapper"><h5 id="x3-1-2-2-variables-setup"><bdi class="secno">3.1.2.2 </bdi>Variables setup</h5><a class="self-link" href="#variables-setup-0" aria-label="Permalink for Section 3.1.2.2"></a></div>
                    <ol class="condition">
                        <li>
                        	<b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.
                        </li>

                        <li>
                        	<b>LET</b> <var>all_necessary_content_textual</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[(@property="schema:<i>accessMode</i>" and normalize-space() = "textual" and count(//meta[@property="schema:<i>accessMode</i>"]) = 1) or (@property="schema:<i>accessModeSufficient</i>" and normalize-space()="<i>textual</i>")]</code>.
                        </li>
                    	
                    	<li>
                    		<b>LET</b> <var>audio_only_content</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessMode</i>" and normalize-space() = "auditory" and count(//meta[@property="schema:<i>accessMode</i>"]) = 1]</code>.
                    	</li>
                    	
                        <li>
                        	<b>LET</b> <var>some_sufficient_text</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[(@property="schema:accessMode" and contains(normalize-space(), "textual")) or (@property="schema:accessModeSufficient" and contains(normalize-space(), "textual"))]</code>.
                        </li>
                    	
                    	<li>
                    		<b>LET</b> <var>textual_alternatives</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="<i>schema:accessibilityFeature</i>" and normalize-space()=("<i>longDescription</i>", "<i>alternativeText</i>", "<i>describedMath"</i>, "<i>transcript</i>")]</code>.
                    	</li>
                    	
                    	<li>
                    		<b>LET</b> <var>visual_only_content</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[(@property="schema:<i>accessMode</i>" and normalize-space() = "visual" and count(//meta[@property="schema:<i>accessMode</i>"]) = 1) and not(//meta[@property="schema:<i>accessModeSufficient</i>" and contains(normalize-space(), "<i>textual</i>")])]</code>.
                    	</li>
                    </ol>
                    </section><section id="instructions-0"><div class="header-wrapper"><h5 id="x3-1-2-3-instructions"><bdi class="secno">3.1.2.3 </bdi>Instructions</h5><a class="self-link" href="#instructions-0" aria-label="Permalink for Section 3.1.2.3"></a></div>
                    <ol class="condition">
                        <li>
                            <span><b>IF</b> <var>all_necessary_content_textual</var>:</span>
                            <span><b>THEN</b> display <code id="ways-of-reading-nonvisual-reading-readable">"Readable in read aloud or dynamic braille"</code><span class="str-id">[ID: ways-of-reading-nonvisual-reading-readable]</span>.</span>
                        </li>
                    	
                    	<li>
                            <span><b>ELSE IF</b> <var>some_sufficient_text</var> <b>OR</b> <var>textual_alternatives</var>:</span>
                            <span><b>THEN</b> display <code id="ways-of-reading-nonvisual-reading-not-fully">"Not fully readable in read aloud or dynamic braille"</code><span class="str-id">[ID: ways-of-reading-nonvisual-reading-not-fully]</span>.</span>
                        </li>
                    	
                    	<li>
                    		<span><b>ELSE IF</b> <var>audio_only_content</var> or <var>visual_only_content</var>:</span>
                    		<span><b>THEN</b> display <code id="ways-of-reading-nonvisual-reading-none">"Not readable in read aloud or dynamic braille"</code><span class="str-id">[ID: ways-of-reading-nonvisual-reading-none]</span>.</span>
                    	</li>
                    	
                    	<li><b>ELSE</b> display <code id="ways-of-reading-nonvisual-reading-no-metadata">"No information about nonvisual reading is available"</code><span class="str-id">[ID: ways-of-reading-nonvisual-reading-no-metadata]</span>.</li>
                    	
                    	<li>
                    		<span><b>IF</b> <var>textual_alternatives</var>:</span>
                    		<span><b>THEN</b> display <code id="ways-of-reading-nonvisual-reading-alt-text">"Has alternative text"</code><span class="str-id">[ID: ways-of-reading-nonvisual-reading-alt-text]</span>.</span>
                    	</li>
                    </ol>


                </section></section>
                
                <section id="prerecorded-audio"><div class="header-wrapper"><h4 id="x3-1-3-prerecorded-audio"><bdi class="secno">3.1.3 </bdi>Prerecorded audio</h4><a class="self-link" href="#prerecorded-audio" aria-label="Permalink for Section 3.1.3"></a></div>
                    
                    <p>This technique relates to the <a href="../../guidelines/#prerecorded-audio">Prerecorded audio accessibility display field</a>.</p>

                     <section id="understanding-the-variables-1"><div class="header-wrapper"><h5 id="x3-1-3-1-understanding-the-variables"><bdi class="secno">3.1.3.1 </bdi>Understanding the variables</h5><a class="self-link" href="#understanding-the-variables-1" aria-label="Permalink for Section 3.1.3.1"></a></div>
                    <dl>
                        <dt><var>all_content_audio</var></dt>
                        <dd>
                            <p>If true it indicates that the <i>accessModeSufficient="auditory"</i> (all main content is provided in audio form) is present in the package document, otherwise if false it means that the metadata is not present.</p>
                        </dd>
                        
                        <dt><var>audio_content</var></dt>
                        <dd>
                            <p>If true it indicates that the <i>accessMode="auditory"</i> is present in the package document, otherwise, if false, it means that the metadata is not present.</p>

                            <p>This indicates that prerecorded audio content is included as part of the work.</p>
                        </dd>

                        <dt><var>synchronised_pre_recorded_audio</var></dt>
                        <dd>
                            <p>If true it indicates that the <i>accessibilityFeature="synchronizedAudioText"</i> is present in the package document, otherwise, if false, it means that the metadata is not present.</p>

                            <p>This indicates that text-synchronised prerecorded audio narration (natural or synthesized voice) is included for substantially all textual matter, including all alternative descriptions, e.g. via a SMIL media overlay.</p>
                        </dd>
                    </dl>
                    </section><section id="variables-setup-1"><div class="header-wrapper"><h5 id="x3-1-3-2-variables-setup"><bdi class="secno">3.1.3.2 </bdi>Variables setup</h5><a class="self-link" href="#variables-setup-1" aria-label="Permalink for Section 3.1.3.2"></a></div>
                    <ol class="condition">
                        <li><b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.</li>

                        <li><b>LET</b> <var>all_content_audio</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessModeSufficient</i>" and normalize-space()="<i>auditory</i>"]</code>.</li>

                        <li><b>LET</b> <var>audio_content</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessMode</i>" and normalize-space()="<i>auditory</i>"]</code>.</li>

                        <li><b>LET</b> <var>synchronised_pre_recorded_audio</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>synchronizedAudioText</i>"]</code>.</li>

                    </ol>
                    </section><section id="instructions-1"><div class="header-wrapper"><h5 id="x3-1-3-3-instructions"><bdi class="secno">3.1.3.3 </bdi>Instructions</h5><a class="self-link" href="#instructions-1" aria-label="Permalink for Section 3.1.3.3"></a></div>
                    <ol class="condition">
                        <li>
                            <span><b>IF</b> <var>synchronised_pre_recorded_audio</var>:</span>
                            <span><b>THEN</b> display <code id="ways-of-reading-prerecorded-audio-synchronized">"Prerecorded audio synchronized with text"</code><span class="str-id">[ID: ways-of-reading-prerecorded-audio-synchronized]</span>.</span>
                        </li>
                        <li>
                            <span><b>ELSE IF</b> <var>all_content_audio</var>:</span>
                            <span><b>THEN</b> display <code id="ways-of-reading-prerecorded-audio-only">"Prerecorded audio only"</code><span class="str-id">[ID: ways-of-reading-prerecorded-audio-only]</span>.</span>
                        </li>
                        <li>
                            <span><b>ELSE IF</b> <var>audio_content</var>:</span>
                            <span><b>THEN</b> display <code id="ways-of-reading-prerecorded-audio-complementary">"Prerecorded audio clips"</code><span class="str-id">[ID: ways-of-reading-prerecorded-audio-complementary]</span>.</span>
                        </li>

                        <li>
                            <b>ELSE</b> either omit this display field if metadata is missing or display <code id="ways-of-reading-prerecorded-audio-no-metadata">"No information about prerecorded audio is available"</code><span class="str-id">[ID: ways-of-reading-prerecorded-audio-no-metadata]</span>.
                        </li>
                    </ol>
                </section></section>

            </section>

			<section id="conformance-group"><div class="header-wrapper"><h3 id="x3-2-conformance"><bdi class="secno">3.2 </bdi>Conformance</h3><a class="self-link" href="#conformance-group" aria-label="Permalink for Section 3.2"></a></div>
				
				<p>This technique relates to the <a href="../../guidelines/#conformance-group">Conformance accessibility display field</a>.</p>

				<p>This algorithm takes the <var>package_document_as_text</var> argument: a UTF-8 string representing the Package document.</p>

				<section id="understanding-the-variables-2"><div class="header-wrapper"><h4 id="x3-2-1-understanding-the-variables"><bdi class="secno">3.2.1 </bdi>Understanding the variables</h4><a class="self-link" href="#understanding-the-variables-2" aria-label="Permalink for Section 3.2.1"></a></div>
				<dl>
					<dt><var>certifier</var></dt>
					<dd>
						<p>Returns the description of <i>a11y:certifiedBy</i> (Compliance certification by (name)) if present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that the name of the organization responsible for compliance testing and certification of the product is present.</p>
					</dd>
					<dt><var>certifier_credentials</var></dt>
					<dd>
						<p>Returns the description of <i>a11y:certifierCredential</i> (Compliance certification by (URL) or text) if present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that the the URL of a web page belonging to an organization responsible for compliance testing and certification of the product is present – typically a ‘home page’ or a page describing the certification scheme itself.</p>
					</dd>
					<dt><var>certification_date</var></dt>
					<dd>
						<p>Returns the description of <i>dcterms:date</i> if that date property is associated with the <i>a11y:certifiedBy</i> (Latest accessibility assessment date) if present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that the date of the latest assessment or re-assessment of the accessibility of the product is present.</p>
					</dd>
					<dt><var>certifier_report</var></dt>
					<dd>
						<p>Returns the description of <i>a11y:certifierReport</i> (Compliance web page for detailed accessibility information) if present in the OPF, otherwise if false it means that the metadata is not present.</p>
						<p>This means that is present the URL of a compliance web page for detailed accessibility information. The web page should be maintained by an independent compliance scheme or testing organization. Note the web page may include information about specific national requirements or voluntary conformance reports.</p>
					</dd>
                    <dt><var>conformance-claimed</var></dt>
					<dd>
						<p>If true it indicates that the <i>conformsTo</i> is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that the publication conforms to some specification.</p>
					</dd>
					<dt><var>epub_version</var></dt>
					<dd>
                        <p>If set, provides the version of the EPUB Accessibility specification the
                        	publication conforms to.</p>
					</dd>
					<dt><var>wcag_version</var></dt>
					<dd>
                        <p>If set, provides the WCAG 2 conformance level claimed.</p>
					</dd>
				</dl>

				</section><section id="variables-setup-2"><div class="header-wrapper"><h4 id="x3-2-2-variables-setup"><bdi class="secno">3.2.2 </bdi>Variables setup</h4><a class="self-link" href="#variables-setup-2" aria-label="Permalink for Section 3.2.2"></a></div>
				<ol class="condition">
					<li><b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.</li>

                
                 <li>
                     <span><b>IF</b> the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/link[@rel="dcterms:<i>conformsTo</i>" and @href="<i>http://www.idpf.org/epub/a11y/accessibility-20170105.html#wcag-a</i>"] | /package/metadata/meta[@property="dcterms:conformsTo" and normalize-space() = "http://www.idpf.org/epub/a11y/accessibility-20170105.html#wcag-a"]</code> :</span>
                     <span><b>THEN LET</b> <var>epub_version</var> = '1.0', and</span>
                 	<span><b>LET</b> <var>wcag_version</var> = '2.0', and</span>
                 	<span><b>LET</b> <var>wcag_level</var> = 'A'.</span>
                 </li>

                  <li>
                       <span><b>IF</b> the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/link[@rel="dcterms:<i>conformsTo</i>" and @href="<i>http://www.idpf.org/epub/a11y/accessibility-20170105.html#wcag-aa</i>"] | /package/metadata/meta[@property="dcterms:conformsTo" and normalize-space() = "http://www.idpf.org/epub/a11y/accessibility-20170105.html#wcag-aa"]</code>:</span>
                  	<span><b>THEN LET</b> <var>epub_version</var> = '1.0', and</span>
                  	<span><b>LET</b> <var>wcag_version</var> = '2.0', and</span>
                  	<span><b>LET</b> <var>wcag_level</var> = 'AA'.</span>
                  </li>

                  <li>
                      <span><b>IF</b> the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/link[@rel="dcterms:<i>conformsTo</i>" and @href="<i>http://www.idpf.org/epub/a11y/accessibility-20170105.html#wcag-aaa</i>"] | /package/metadata/meta[@property="dcterms:conformsTo" and normalize-space() = "http://www.idpf.org/epub/a11y/accessibility-20170105.html#wcag-aaa"]</code>:</span>
                  	<span><b>THEN LET</b> <var>epub_version</var> = '1.0', and</span>
                  	<span><b>LET</b> <var>wcag_version</var> = '2.0', and</span>
                  	<span><b>LET</b> <var>wcag_level</var> = 'AAA'.</span>
                  </li>

                   
					<li><b>LET</b> <var>conformance</var> be the value of the node extracted from <var>package_document</var>, using the xpath <code class="xpath">/package/metadata/meta[@property="dcterms:<i>conformsTo</i>" and matches(normalize-space(), 'EPUB Accessibility 1\.1 - WCAG 2\.[0-2] Level [A]+')]</code>.</li>

				   <li>
                  	<span><b>IF</b> <var>conformance</var> is <b>NOT</b> empty:</span>
				   	<span><b>THEN LET</b> <var>epub_version</var> = '1.1', and</span>
				   	<span><b>LET</b> <var>wcag_version</var> = replace(<var>conformance</var>, 'EPUB Accessibility 1\.1 - WCAG (2\.[0-2]) Level [A]+', '$1'), and</span>
				   	<span><b>LET</b> <var>wcag_level</var> = replace(<var>conformance</var>, 'EPUB Accessibility 1\.1 - WCAG 2\.[0-2] Level ', '').</span>
                    </li>

                    <li><b>LET</b> <var>certifier</var> be the value of the node extracted from <var>package_document</var>, using the xpath <code class="xpath">/package/metadata/meta[@property="a11y:<i>certifiedBy</i>"]</code>.</li>

                    <li><b>LET</b> <var>certifier_credentials</var> be the value of the node extracted from <var>package_document</var>, using the xpath <code class="xpath">/package/metadata/meta[@property="a11y:<i>certifierCredential</i>"]</code>.</li>

                    <li><b>LET</b> <var>certification_date</var> be the value of the node extracted from <var>package_document</var>, using the xpath <code class="xpath">/package/metadata/meta[@property="dcterms:date" and @refines=//meta[@property="a11y:certifiedBy"]/@id]</code>.</li>

                    <li><b>LET</b> <var>certifier_report</var> be the value of the node extracted from <var>package_document</var>, using the xpath <code class="xpath">/package/metadata/meta[@property="a11y:<i>certifierReport</i>"]</code>.</li>
				</ol>

				</section><section id="instructions-2"><div class="header-wrapper"><h4 id="conformance-instructions"><bdi class="secno">3.2.3 </bdi>Instructions</h4><a class="self-link" href="#conformance-instructions" aria-label="Permalink for Section 3.2.3"></a></div>
				<ol class="condition">
					<li><span><b>IF</b> <b>NOT</b> <var>epub_version</var> <b>AND NOT</b> <var>wcag_version</var>:</span>
						<span><b>THEN</b> display <code id="conformance-no">"No information is available"</code><span class="str-id">[ID: conformance-no]</span>.</span>
					</li>
					<li>
						<span><b>ELSE</b>:</span>
						<ul class="condition">
							<li>
								<span><b>IF</b> <var>wcag_level</var> == 'AAA':</span>
								<span><b>THEN</b> display <code id="conformance-aaa">"This publication exceeds accepted accessibility standards"</code><span class="str-id">[ID: conformance-aaa]</span>.</span>
							</li>
							<li>
								<span><b>ELSE IF</b> <var>wcag_level</var> == 'AA':</span>
								<span><b>THEN</b> display <code id="conformance-aa">"This publication meets accepted accessibility standards"</code><span class="str-id">[ID: conformance-aa]</span>.</span>
							</li>
							<li>
								<span><b>ELSE IF</b> <var>wcag_level</var> == 'A':</span>
								<span><b>THEN</b> display <code id="conformance-a">"This publication meets minimum accessibility standards"</code><span class="str-id">[ID: conformance-a]</span>.</span>
							</li>
                            <li>
                                <span><b>ELSE</b></span>
								<span><b>THEN</b> display <code id="conformance-unknown-standard">"Conformance to accepted standards for accessibility of this publication cannot be determined"</code><span class="str-id">[ID: conformance-unknown-standard]</span>.</span>
                            </li>
							<li>
								<span><b>IF</b> <var>certifier</var> is <b>NOT</b> empty:</span>
								<span><b>THEN</b></span>
								<ul class="condition">
									<li>display <code id="conformance-certifier">"The publication was certified by "</code><span class="str-id">[ID: conformance-certifier]</span></li>
									<li>display <var>certifier</var>.</li>
								</ul>
							</li>
							<li>
								<span><b>IF</b> <var>certifier_credentials</var> is <b>NOT</b> empty:</span>
								<span><b>THEN</b></span>
								<ul class="condition">
									<li>display <code id="conformance-certifier-credentials">"The certifier's credential is "</code><span class="str-id">[ID: conformance-certifier-credentials]</span></li>
									<li>
                                        <span><b>IF</b> <var>certifier_credentials</var> is a URL.</span>
                                        <span><b>THEN</b> display <var>certifier_credentials</var> as link.</span>
                                    </li>
									<li>
                                        <span><b>ELSE</b> display <var>certifier_credentials</var> as text.</span>
                                    </li>

								</ul>
							</li>
							<li>
								<div class="note" role="note" id="issue-container-generatedID-5"><div role="heading" class="note-title marker" id="h-note-4" aria-level="4"><span>Note</span></div><div class="">
									<p>The instructions from here on define the output for the detailed conformance
										information. Refer to the 
										<a href="../../guidelines/#detailed-conformance-information">Detailed Conformance section</a>
										in the guidelines for more information on how to present these strings.</p>
								</div></div>
								
								<span>Display <code id="conformance-details-claim">"This publication claims to meet"</code><span class="str-id">[ID: conformance-details-claim]</span>.</span>
								<ul>
									<li>
										<span><b>IF</b> <var>epub_version</var> == '<code>1.0</code>':</span>
										<span><b>THEN</b> display <code id="conformance-details-epub-accessibility-1-0">" EPUB Accessibility 1.0"</code><span class="str-id">[ID: conformance-details-epub-accessibility-1-0]</span>.</span>
									</li>
									<li>
										<span><b>ELSE IF</b>  <var>epub_version</var> == '<code>1.1</code>':</span>
										<span><b>THEN</b> display <code id="conformance-details-epub-accessibility-1-1">" EPUB Accessibility 1.1"</code><span class="str-id">[ID: conformance-details-epub-accessibility-1-1]</span>.</span>
									</li>
									<li>
										<span><b>IF</b> <var>wcag_version</var> == '<code>2.2</code>':</span>
										<span><b>THEN</b> display <code id="conformance-details-wcag-2-2">" WCAG 2.2"</code><span class="str-id">[ID: conformance-details-wcag-2-2]</span>.</span>
									</li>
									<li>
										<span><b>ELSE IF</b> <var>wcag_version</var> == '<code>2.1</code>':</span>
										<span><b>THEN</b> display <code id="conformance-details-wcag-2-1">" WCAG 2.1"</code><span class="str-id">[ID: conformance-details-wcag-2-1]</span>.</span>
									</li>
									<li>
										<span><b>ELSE IF</b> <var>wcag_version</var> == '<code>2.0</code>':</span>
										<span><b>THEN</b> display <code id="conformance-details-wcag-2-0">" WCAG 2.0"</code><span class="str-id">[ID: conformance-details-wcag-2-0]</span>.</span>
									</li>
									<li>
										<span><b>IF</b> <var>wcag_level</var> == '<code>AAA</code>':</span>
										<span><b>THEN</b> display <code id="conformance-details-level-aaa">" Level AAA"</code><span class="str-id">[ID: conformance-details-level-aaa]</span>.</span>
									</li>
									<li>
										<span><b>ELSE IF</b> <var>wcag_level</var> == '<code>AA</code>':</span>
										<span><b>THEN</b> display <code id="conformance-details-level-aa">" Level AA"</code><span class="str-id">[ID: conformance-details-level-aa]</span>.</span>
									</li>
									<li>
										<span><b>ELSE IF</b> <var>wcag_level</var> == '<code>A</code>':</span>
										<span><b>THEN</b> display <code id="conformance-details-level-a">" Level A"</code><span class="str-id">[ID: conformance-details-level-a]</span>.</span>
									</li>
								</ul>
							</li>
							<li>
								<span><b>IF</b> <var>certification_date</var> <b>THEN</b>:</span>
                                <ul class="condition">

                                	<li>display <code id="conformance-details-certification-info">"The publication was certified on "</code><span class="str-id">[ID: conformance-details-certification-info]</span></li>
									<li>display <var>certification_date</var>.</li>
								</ul>
							</li>
							<li>
								<span><b>IF</b> <var>certifier_report</var>:</span>
								<span><b>THEN</b></span>
								<ul class="condition">
									<li>display <code id="conformance-details-certifier-report">"For more information refer to the certifier's report"</code><span class="str-id">[ID: conformance-details-certifier-report]</span> as a named link with <var>certifier_report</var> as the URL used.</li>
								</ul>
							</li>
						</ul>
					</li>
				</ol>
			</section></section>


	      <section id="navigation"><div class="header-wrapper"><h3 id="x3-3-navigation"><bdi class="secno">3.3 </bdi>Navigation</h3><a class="self-link" href="#navigation" aria-label="Permalink for Section 3.3"></a></div>
			
    	  	<p>This technique relates to the <a href="../../guidelines/#navigation">Navigation accessibility display field</a>.</p>
                <p>This algorithm takes the <var>package_document_as_text</var> argument: a UTF-8 string representing the Package document.</p>

				<section id="understanding-the-variables-3"><div class="header-wrapper"><h4 id="x3-3-1-understanding-the-variables"><bdi class="secno">3.3.1 </bdi>Understanding the variables</h4><a class="self-link" href="#understanding-the-variables-3" aria-label="Permalink for Section 3.3.1"></a></div>
				<dl>
					<dt><var>index_navigation</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityFeature="index"</i> (Index navigation) is present in the package document, otherwise if false it means that the metadata is not present.</p>

                        <p>This means that there is an index that provides direct (eg hyperlinked) access to uses of the index terms in the document body.</p>
					</dd>
 					<dt><var>next_previous_structural_navigation</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityFeature="structuralNavigation"</i> (Next / Previous structural navigation) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that all levels of heading and other structural elements of the content are correctly marked up and (if applicable) numbered, to enable fast next heading / previous heading, next chapter / previous chapter navigation without returning to the table of contents.</p>
					</dd>
                   <dt><var>page_navigation</var></dt>
                    <dd>
                        <p>If true it indicates that the <i>accessibilityFeature="pageNavigation"</i> (Page Navigation) is present in the package document, otherwise if false it means that the metadata is not present.</p>
                        <p>This means that the e-publication includes a means of navigating to static page break locations.</p>
                    </dd>
					<dt><var>table_of_contents_navigation</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityFeature="tableOfContents"</i> (Table of contents navigation) is present in the package document, otherwise if false it means that the metadata is not present.</p>

						<p>This means that the resource includes a table of contents that provides links to the major sections of the content.</p>
					</dd>
				</dl>
				</section><section id="variables-setup-3"><div class="header-wrapper"><h4 id="x3-3-2-variables-setup"><bdi class="secno">3.3.2 </bdi>Variables setup</h4><a class="self-link" href="#variables-setup-3" aria-label="Permalink for Section 3.3.2"></a></div>
				<ol class="condition">

 					<li><b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.</li>

                    <li><b>LET</b> <var>index_navigation</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>index</i>"]</code>.</li>

                    <li><b>LET</b> <var>next_previous_structural_navigation</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>structuralNavigation</i>"]</code>.</li>
                    
                    <li><b>LET</b> <var>page_navigation</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>pageNavigation</i>"]</code>.</li>

                    <li><b>LET</b> <var>table_of_contents_navigation</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>tableOfContents</i>"]</code>.</li>

  				</ol>
				</section><section id="instructions-3"><div class="header-wrapper"><h4 id="navigation-instructions"><bdi class="secno">3.3.3 </bdi>Instructions</h4><a class="self-link" href="#navigation-instructions" aria-label="Permalink for Section 3.3.3"></a></div>
				<ol class="condition">
					<li>
						<span><b>IF</b> <var>table_of_contents_navigation</var> <b>OR</b> <var>index_navigation</var> <b>OR</b> <var>page_navigation</var> <b>OR</b> <var>next_previous_structural_navigation</var>:</span>

						<ol class="condition">
                            <li>
							    <span><b>IF</b> <var>page_navigation</var>:</span>
				                <span><b>THEN</b> display <code id="navigation-page-navigation">"Go to page"</code><span class="str-id">[ID: navigation-page-navigation]</span>.</span>
							</li>
							<li>
 							<span><b>IF</b> <var>next_previous_structural_navigation</var>:</span>
								<span><b>THEN</b> display <code id="navigation-structural">"Headings"</code><span class="str-id">[ID: navigation-structural]</span>.</span>
							</li>
							<li>
								<span><b>IF</b> <var>index_navigation</var>:</span>
								<span><b>THEN</b> display <code id="navigation-index">"Index"</code><span class="str-id">[ID: navigation-index]</span>.</span>
							</li>
                            <li>
								<span><b>IF</b> <var>table_of_contents_navigation</var>:</span>
								<span><b>THEN</b> display <code id="navigation-toc">"Table of contents"</code><span class="str-id">[ID: navigation-toc]</span>.</span>
							</li>
                        </ol>
				    </li>



					<li>
						<b>ELSE</b> either omit this display field if metadata is missing or display <code id="navigation-no-metadata">"No information is available"</code><span class="str-id">[ID: navigation-no-metadata]</span>.
					</li>
				</ol>
			</section></section>

			<section id="rich-content"><div class="header-wrapper"><h3 id="x3-4-rich-content"><bdi class="secno">3.4 </bdi>Rich content</h3><a class="self-link" href="#rich-content" aria-label="Permalink for Section 3.4"></a></div>
				
				<p>This technique relates to the <a href="../../guidelines/#rich-content">Rich content accessibility display field</a>.</p>

                <p>This algorithm takes the <var>package_document_as_text</var> argument: a UTF-8 string representing the Package document.</p>
				<section id="understanding-the-variables-4"><div class="header-wrapper"><h4 id="x3-4-1-understanding-the-variables"><bdi class="secno">3.4.1 </bdi>Understanding the variables</h4><a class="self-link" href="#understanding-the-variables-4" aria-label="Permalink for Section 3.4.1"></a></div>
				<dl>
                    <dt><var>chemical_formula_as_latex</var></dt>
					<dd>
						<p>If true it indicates that the <i>accessibilityFeature="latex-chemistry"</i> (Accessible chemistry content as Latex) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication that the chemical formulae are presented using Latex and works with compatible assistive technology.</p>
					</dd>
					<dt><var>chemical_formula_as_mathml</var></dt>
					<dd>
						<p>If true it indicates that the <i>accessibilityFeature="MathML-chemistry"</i> (Accessible chemistry content as MathML) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication that the chemical formulae are presented using MathML and works with compatible assistive technology.</p>
					</dd>
                    <dt><var>closed_captions</var></dt>
                        <dd>
                        <p>If true it indicates that the <i>accessibilityFeature="closedCaptions"</i> (Closed captions) is present in the package document, otherwise if false it means that the metadata is not present.</p>
                        <p>This means that the audio content of a video can be seen via closed captions that can be turned on or off  by the viewer and which will be a separate file from the video itself.</p>
                    </dd>

					<dt><var>contains_charts_diagrams</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessMode="chartOnVisual"</i> (charts encoded in visual form) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication that the product has some information conveyed via some form of illustration, such as a graph, a chart, a diagram, a figure, etc).</p>
					</dd>
					<dt><var>contains_chemical_formula</var></dt>
					<dd>
						<p>If true it indicates that the <i>accessMode="chemOnVisual"</i> (Chemical content) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication that the publication contains chemical notations, formulae.</p>
					</dd>

					<dt><var>contains_math_formula</var></dt>
					<dd>
						<p>If true it indicates that the <i>accessibilityFeature="describedMath"</i> (Mathematical content) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication that the publication contains mathematical notation, equations, formulae.</p>
					</dd>
					<dt><var>full_alternative_textual_descriptions</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityFeature="longDescriptions"</i> (Full alternative textual description) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication that a full alternative textual description has been supplied for all of the graphs, charts, diagrams, or figures necessary to understand the content.</p>
					</dd>
                    
					<dt><var>math_formula_as_latex</var></dt>
					<dd>
						<p>If true it indicates that the <i>accessibilityFeature="latex"</i> (Accessible math content as LaTeX) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication that the  math  is  presented using LaTeX and works with compatible assistive technology.</p>
					</dd>
					<dt><var>math_formula_as_mathml</var></dt>
					<dd>
						<p>If true it indicates that the <i>accessibilityFeature="MathML"</i> (Accessible math content as MathML) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication that all mathematical content is presented using MathML and works with compatible assistive technology.</p>
					</dd>
                    <dt><var>open_captions</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="openCaptions"</i> (Open captions) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that the audio content of a video can be seen via open captions, which means they cannot be turned off and are always visible when the video plays.</p>
						</dd>
                    <dt><var>transcript</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="transcript"</i> (transcript) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that a transcript of the audio content of the product is supplied with it.</p>
						</dd>
				</dl>
				</section><section id="variables-setup-4"><div class="header-wrapper"><h4 id="x3-4-2-variables-setup"><bdi class="secno">3.4.2 </bdi>Variables setup</h4><a class="self-link" href="#variables-setup-4" aria-label="Permalink for Section 3.4.2"></a></div>
				<ol class="condition">
					<li><b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.</li>

                   <li><b>LET</b> <var>chemical_formula_as_latex</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>latex-chemistry</i>"]</code>.</li>
                    
                    <li><b>LET</b> <var>chemical_formula_as_mathml</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>MathML-chemistry</i>"]</code>.</li>

  	                <li><b>LET</b> <var>closed_captions</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>closedCaptions</i>"]</code>.</li>

                    <li><b>LET</b> <var>contains_charts_diagrams</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessMode</i>" and normalize-space()="<i>chartOnVisual</i>"]</code>.</li>
                    
                    <li><b>LET</b> <var>contains_chemical_formula</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessMode</i>" and normalize-space()="<i>chemOnVisual</i>"]</code>.</li>                    

 	                <li><b>LET</b> <var>contains_math_formula</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>describedMath</i>"]</code>.</li>

					<li><b>LET</b> <var>full_alternative_textual_descriptions</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>longDescriptions</i>"]</code>.</li>

 	                <li><b>LET</b> <var>math_formula_as_latex</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>latex</i>"]</code>.</li>

	                <li><b>LET</b> <var>math_formula_as_mathml</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>MathML</i>"]</code>.</li>

                    <li><b>LET</b> <var>open_captions</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>openCaptions</i>"]</code>.</li>
                    
                    <li><b>LET</b> <var>transcript</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>transcript</i>"]</code>.</li>
				</ol>
				</section><section id="instructions-4"><div class="header-wrapper"><h4 id="rich-content-instructions"><bdi class="secno">3.4.3 </bdi>Instructions</h4><a class="self-link" href="#rich-content-instructions" aria-label="Permalink for Section 3.4.3"></a></div>
				<ol class="condition">
                    <li>
                    	<span><b>IF</b> <var>full_alternative_textual_descriptions</var>:</span>
						<span><b>THEN</b> display <code id="rich-content-extended">"Information-rich images are described by extended descriptions"</code><span class="str-id">[ID: rich-content-extended]</span>.</span>
					</li>
                   <li>
						<span><b>IF</b> <var>chemical_formula_as_latex</var>:</span>
						<span><b>THEN</b> display <code id="rich-content-accessible-chemistry-as-latex">"Chemical formulas in LaTeX"</code><span class="str-id">[ID: rich-content-accessible-chemistry-as-latex]</span>.</span>
					</li>
   					<li>
						<span><b>IF</b> <var>chemical_formula_as_mathml</var>:</span>
						<span><b>THEN</b> display <code id="rich-content-accessible-chemistry-as-mathml">"Chemical formulas in MathML"</code><span class="str-id">[ID: rich-content-accessible-chemistry-as-mathml]</span>.</span>
					</li>
					<li>
						<span><b>IF</b> <var>contains_math_formula</var>:</span>
						<span><b>THEN</b> display <code id="rich-content-accessible-math-described">"Text descriptions of math are provided"</code><span class="str-id">[ID: rich-content-accessible-math-described]</span>.</span>
					</li>
					<li>
						<span><b>IF</b> <var>math_formula_as_latex</var>:</span>
						<span><b>THEN</b> display <code id="rich-content-accessible-math-as-latex">"Math as LaTeX"</code><span class="str-id">[ID: rich-content-accessible-math-as-latex]</span>.</span>
					</li>

                    <li>
						<span><b>IF</b> <var>math_formula_as_mathml</var>:</span>
						<span><b>THEN</b> display <code id="rich-content-accessible-math-as-mathml">"Math as MathML"</code><span class="str-id">[ID: rich-content-accessible-math-as-mathml]</span>.</span>
					</li>
                    
 					<li>
						<span><b>IF</b> <var>closed_captions</var>:</span>
						<span><b>THEN</b> display <code id="rich-content-closed-captions">"Videos have closed captions"</code><span class="str-id">[ID: rich-content-closed-captions]</span>.</span>
					</li>
 					<li>
						<span><b>IF</b> <var>open_captions</var>:</span>
						<span><b>THEN</b> display <code id="rich-content-open-captions">"Videos have open captions"</code><span class="str-id">[ID: rich-content-open-captions]</span>.</span>
					</li>
					<li>
						<span><b>IF</b> <var>transcript</var>:</span>
						<span><b>THEN</b> display <code id="rich-content-transcript">"Transcript(s) provided"</code><span class="str-id">[ID: rich-content-transcript]</span>.</span>
					</li>
                                        
					<li>
						<span><b>IF</b> <b>NOT</b> (<var>math_formula_as_mathml</var> <b>OR</b> <var>math_formula_as_latex</var> <b>OR</b> (<var>contains_math_formula</var> <b>AND</b> <var>full_alternative_textual_descriptions</var>) <b>OR</b> <var>chemical_formula_as_mathml</var> <b>OR</b> <var>full_alternative_textual_descriptions</var> <b>OR</b> <var>closed_captions</var> <b>OR</b> <var>open_captions</var> <b>OR</b> <var>transcript</var>):</span>
						<span><b>THEN</b> either omit this display field if metadata is missing or display <code id="rich-content-unknown">"No information is available"</code><span class="str-id">[ID: rich-content-unknown]</span>.</span>
					</li>
				</ol>
			</section></section>

			<section id="hazards"><div class="header-wrapper"><h3 id="x3-5-hazards"><bdi class="secno">3.5 </bdi>Hazards</h3><a class="self-link" href="#hazards" aria-label="Permalink for Section 3.5"></a></div>
				
				<p>This technique relates to the <a href="../../guidelines/#hazards">Hazards accessibility display field</a>.</p>
				<p>This algorithm takes the <var>package_document_as_text</var> argument: a UTF-8 string representing the Package document.</p>

        <section id="understanding-the-variables-5"><div class="header-wrapper"><h4 id="x3-5-1-understanding-the-variables"><bdi class="secno">3.5.1 </bdi>Understanding the variables</h4><a class="self-link" href="#understanding-the-variables-5" aria-label="Permalink for Section 3.5.1"></a></div>
				<dl>
					<dt><var>flashing_hazard</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityHazard="flashing"</i> (WARNING - Flashing hazards) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication in the accessibility metadata within the EPUB confirming that the product has a flashing hazard which must be displayed.</p>
					</dd>
					<dt><var>motion_simulation_hazard</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityHazard="motionSimulation"</i> (WARNING - Motion simulation hazard) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that there is a positive indication in the accessibility metadata within the EPUB confirming that the product has a motion simulation hazard which must be displayed.</p>
					</dd>
					<dt><var>no_flashing_hazards</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityHazard="noFlashingHazard"</i> (No flashing hazard warning necessary) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means there is a positive indication in the accessibility metadata within the EPUB confirming there are no flashing hazards associated with this product.</p>
					</dd>
					<dt><var>no_hazards_or_warnings_confirmed</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityHazard="none"</i> (no accessibility hazards) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means there is a positive indication in the accessibility metadata within the EPUB confirming there are no associated hazard warnings with this product.</p>
					</dd>
					<dt><var>no_motion_hazards</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityHazard="noMotionSimulationHazard"</i> (No motion simulation hazard warning necessary) is present in the package document, otherwise if false it means that the metadata is not present.</p> 		<p>This means there is a positive indication in the accessibility metadata within the EPUB confirming there are no motion simulation hazards associated with this product.</p>
					</dd>
					<dt><var>no_sound_hazards</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityHazard="noSoundHazard"</i> (No sound hazard warning necessary) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means there is a positive indication in the accessibility metadata within the EPUB confirming there are no sound hazards associated with this product.</p>
					</dd>
					<dt><var>sound_hazard</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityHazard="Sound"</i> (WARNING - Sound hazard) is present in the package document, otherwise if false it means that the metadata is not present.</p>
 						<p>This means that there is a positive indication in the accessibility metadata within the EPUB confirming that the product has a sound hazard which must be displayed.</p>
					</dd>
					<dt><var>unknown_if_contains_hazards</var></dt>
					<dd>
                        <p>If true it indicates that the <i>accessibilityHazard="unknown"</i> (unknown hazards) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that the product has not been assessed for hazards and there is no information about potential hazards.</p>
					</dd>

				</dl>

				</section><section id="variables-setup-5"><div class="header-wrapper"><h4 id="x3-5-2-variables-setup"><bdi class="secno">3.5.2 </bdi>Variables setup</h4><a class="self-link" href="#variables-setup-5" aria-label="Permalink for Section 3.5.2"></a></div>
				<ol class="condition">
					<li><b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.</li>

                    <li><b>LET</b> <var>flashing_hazard</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityHazard</i>" and normalize-space()="<i>flashing</i>"]</code>.</li>

                    <li><b>LET</b> <var>motion_simulation_hazard</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityHazard</i>" and normalize-space()="<i>motionSimulation</i>"]</code>.</li>

                    <li><b>LET</b> <var>no_flashing_hazards</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityHazard</i>" and normalize-space()="<i>noFlashingHazard</i>"]</code>.</li>
                    
                    <li><b>LET</b> <var>no_hazards_or_warnings_confirmed</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityHazard</i>" and normalize-space()="<i>none</i>"]</code>.</li>

                    <li><b>LET</b> <var>no_motion_hazards</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityHazard</i>" and normalize-space()="<i>noMotionSimulationHazard</i>"]</code>.</li>

                    <li><b>LET</b> <var>no_sound_hazards</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityHazard</i>" and normalize-space()="<i>noSoundHazard</i>"]</code>.</li>

                    <li><b>LET</b> <var>sound_hazard</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityHazard</i>" and normalize-space()="<i>sound</i>"]</code>.</li>
  
                    <li><b>LET</b> <var>unknown_if_contains_hazards</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityHazard</i>" and normalize-space()="<i>unknown</i>"]</code>.</li>

				</ol>
				</section><section id="instructions-5"><div class="header-wrapper"><h4 id="hazards-instructions"><bdi class="secno">3.5.3 </bdi>Instructions</h4><a class="self-link" href="#hazards-instructions" aria-label="Permalink for Section 3.5.3"></a></div>
				<ol class="condition">
					<li>
						<span><b>IF</b> <var>no_hazards_or_warnings_confirmed</var> <b>OR</b> (<var>no_flashing_hazards</var> <b>AND</b> <var>no_motion_hazards</var> <b>AND</b> <var>no_sound_hazards</var>):</span>
						<span><b>THEN</b> display <code id="hazards-none">"No hazards"</code><span class="str-id">[ID: hazards-none]</span>.</span>
					</li>
					<li>
						<span><b>ELSE IF</b> <var>flashing_hazard</var> <b>OR</b> <var>motion_simulation_hazard</var> <b>OR</b> <var>sound_hazard</var>:</span>
						<b>THEN</b> <ul class="condition">
							<li>
								<span><b>IF</b> <var>flashing_hazard</var>:</span>
								<span><b>THEN</b> display <code id="hazards-flashing">"Flashing content"</code><span class="str-id">[ID: hazards-flashing]</span>.</span>
							</li>
							<li>
								<span><b>IF</b> <var>motion_simulation_hazard</var>:</span>
								<span><b>THEN</b> display <code id="hazards-motion">"Motion simulation"</code><span class="str-id">[ID: hazards-motion]</span>.</span>
							</li>
							<li>
								<span><b>IF</b> <var>sound_hazard</var>:</span>
								<span><b>THEN</b> display <code id="hazards-sound">"Sounds"</code><span class="str-id">[ID: hazards-sound]</span>.</span>
							</li>
						</ul>
					</li>
                    <li>
						<span><b>ELSE IF</b> <var>unknown_if_contains_hazards</var>:</span>
						<span><b>THEN</b> display <code id="hazards-unknown">"The presence of hazards is unknown"</code><span class="str-id">[ID: hazards-unknown]</span>.</span>
                    </li>
					<li>
						<b>ELSE</b> either omit this display field if metadata is missing or display <code id="hazards-no-metadata">"No information is available"</code><span class="str-id">[ID: hazards-no-metadata]</span>.

                    </li>
				</ol>
			</section></section>


			<section id="accessibility-summary"><div class="header-wrapper"><h3 id="x3-6-accessibility-summary"><bdi class="secno">3.6 </bdi>Accessibility summary</h3><a class="self-link" href="#accessibility-summary" aria-label="Permalink for Section 3.6"></a></div>
				
				<p>This technique relates to the <a href="../../guidelines/#accessibility-summary">Accessibility summary accessibility display field</a>.</p>

				<p>This algorithm takes the <var>package_document_as_text</var> argument: a UTF-8 string representing the Package document.</p>

				<div class="note" role="note" id="issue-container-generatedID-6"><div role="heading" class="note-title marker" id="h-note-5" aria-level="4"><span>Note</span></div><p class="">
					Being human-written, the accessibility summary will appear in the original language of the publication. Therefore it is necessary to take care of setting up the correct language tag information.
				</p></div>

				<div class="note" role="note" id="issue-container-generatedID-7"><div role="heading" class="note-title marker" id="h-note-6" aria-level="4"><span>Note</span></div><p class="">Accessibility summaries were necessary when no systems exposed computed accessibility metadata. With more systems now displaying this information, much of the accessibility summary may be redundant. Publishers should focus on adding information not provided within the computed metadata, such as specifying where in a video file a flashing hazard exists, or noting the reason why they failed to meet WCAG-AA due to color contrast issues in the Appendix.</p></div>

				<section id="understanding-the-variables-6"><div class="header-wrapper"><h4 id="x3-6-1-understanding-the-variables"><bdi class="secno">3.6.1 </bdi>Understanding the variables</h4><a class="self-link" href="#understanding-the-variables-6" aria-label="Permalink for Section 3.6.1"></a></div>
				<dl>
					<dt><var>accessibility_summary</var></dt>
					<dd>
						<p>Contains the <i>accessibilitySummary</i> from the package document if it exists, otherwise it will be blank.</p>
						<p>This means there is a human-written text containing a short explanatory summary of the accessibility of the product or the URL of a web page comprising such a summary. Summarizes the already existent information and may add information that the publisher could not express with the other codes.</p>
					</dd>
					<dt><var>lang_attribute_accessibility_summary</var></dt>
					<dd>
						<p>Returns the lang attribute of the node containing the <var>accessibility_summary</var>, or the lang attribute of the nearest ancestor.</p>
						<p>This is the language code in which the text of the Accessibility summary was written.</p>
					</dd>
					<dt><var>language_of_text</var></dt>
					<dd>
						<p>Returns the value of nearest "language" (Language of content) if present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This indicates the main language of the content and therefore the most probable language of accessibility summary.</p>
					</dd>
				</dl>
				</section><section id="variables-setup-6"><div class="header-wrapper"><h4 id="x3-6-2-variables-setup"><bdi class="secno">3.6.2 </bdi>Variables setup</h4><a class="self-link" href="#variables-setup-6" aria-label="Permalink for Section 3.6.2"></a></div>
				<ol class="condition">
                    <li><b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.</li>

                    <li><b>LET</b> <var>accessibility_summary</var> be the value of the node extracted from <var>package_document</var>, using the xpath <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilitySummary</i>"]</code>.</li>

										<li><b>LET</b> <var>lang_attribute_accessibility_summary</var> be the value of the node extracted from <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="<i>schema:accessibilitySummary</i>"]/(@lang|/package/@lang)[last()]/normalize-space(.)</code>.</li>

										<li><b>LET</b> <var>language_of_text</var> be the value of the node extracted from <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/dc:language[1]</code>.</li>
 				</ol>
				</section><section id="instructions-6"><div class="header-wrapper"><h4 id="accessibility-summary-instructions"><bdi class="secno">3.6.3 </bdi>Instructions</h4><a class="self-link" href="#accessibility-summary-instructions" aria-label="Permalink for Section 3.6.3"></a></div>
				<ol class="condition">
                   <li>
						<span><b>IF</b> <var>lang_attribute_accessibility_summary</var> is <b>NOT</b> empty:</span>
						<span><b>THEN</b> <b>LET</b> <var>language_accessibility_summary</var> be the value of <var>lang_attribute_accessibility_summary</var>.</span>
					</li>
					<li>
						<b>ELSE</b> <b>LET</b> <var>language_accessibility_summary</var> be the value of <var>language_of_text</var>.
					</li>
					<li>
						<span><b>IF</b> <var>accessibility_summary</var> is <b>NOT</b> empty:</span>
						<span><b>THEN</b> display the content of <var>accessibility_summary</var> with <var>language_accessibility_summary</var> as language.</span></li>
					<li>
						<b>ELSE</b> either omit this display field if metadata is missing or display <code id="accessibility-summary-no-metadata">"No information is available"</code><span class="str-id">[ID: accessibility-summary-no-metadata]</span>.
					</li>
				</ol>
			</section></section>

            <section id="legal-considerations"><div class="header-wrapper"><h3 id="x3-7-legal-considerations"><bdi class="secno">3.7 </bdi>Legal considerations</h3><a class="self-link" href="#legal-considerations" aria-label="Permalink for Section 3.7"></a></div>
				
                <div class="issue" id="issue-container-number-350"><div role="heading" class="issue-title marker" id="h-issue" aria-level="4"><a href="https://github.com/w3c/publ-a11y/issues/350"><span class="issue-number">Issue 350</span></a><span class="issue-label">: Feedback requested on exceptions and exemptions from publishers <a class="respec-gh-label" href="https://github.com/w3c/publ-a11y/issues/?q=is%3Aissue+is%3Aopen+label%3A%22a11y-display-guide%22" style="background-color: rgb(34, 73, 175); color: rgb(255, 255, 255);" aria-label="GitHub label: a11y-display-guide">a11y-display-guide</a></span></div><div class="">We are actively seeking comments on this "legal consideration" section. If you are a publisher, we want your feedback! Please visit the GitHub Issue tracking linked above to leave a comment.</div></div>

            	<p>This technique relates to the <a href="../../guidelines/#legal-considerations">Legal considerations accessibility display field</a>.</p>

                 <p>This algorithm takes the <var>package_document_as_text</var> argument: a UTF-8 string representing the Package document.</p>

				<section id="understanding-the-variables-7"><div class="header-wrapper"><h4 id="x3-7-1-understanding-the-variables"><bdi class="secno">3.7.1 </bdi>Understanding the variables</h4><a class="self-link" href="#understanding-the-variables-7" aria-label="Permalink for Section 3.7.1"></a></div>
				<dl>

					<dt><var>eaa_exception_disproportionate_burden</var></dt>
					<dd>
						<p>If true it indicates that the <i><a href="https://www.w3.org/TR/epub-a11y-exemption/#exemption-property">a11y:exemption</a>="<a href="https://www.w3.org/TR/epub-a11y-exemption/#exemption-values">eaa_disproportionate_burden</a>"</i> (EAA exception 2 – Disproportionate burden) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that the digital product falls under European Accessibility Act exception for Disproportionate burden (as defined by current regulations). The product may not have to comply with requirements of the EAA if doing so would financially overburden the publisher.</p>
					</dd>
					<dt><var>eaa_exception_fundamental_modification</var></dt>
					<dd>
						<p>If true it indicates that the <i><a href="https://www.w3.org/TR/epub-a11y-exemption/#exemption-property">a11y:exemption</a>="<a href="https://www.w3.org/TR/epub-a11y-exemption/#exemption-values">eaa_fundamental_modification</a>"</i> (EAA exception 3 – Fundamental modification) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that the digital product falls under European Accessibility Act exception for Fundamental modification (as defined by current regulations). The product may not have to comply with requirements of the EAA if doing so requires a fundamental modification of the nature of the product or service.</p>
					</dd>
					<dt><var>eaa_exemption_micro_enterprises</var></dt>
					<dd>
						<p>If true it indicates that the <i><a href="https://www.w3.org/TR/epub-a11y-exemption/#exemption-property">a11y:exemption</a>="<a href="https://www.w3.org/TR/epub-a11y-exemption/#exemption-values">eaa-microenterprise</a>"</i> (EEA exception 1 – Micro-enterprises) is present in the package document, otherwise if false it means that the metadata is not present.</p>
						<p>This means that the digital product falls under European Accessibility Act exemption for Micro-enterprises (as defined by current regulations). The product may not have to comply with requirements of the EAA if the publisher is a micro-enterprise.</p>
					</dd>
                </dl>
				</section><section id="variables-setup-7"><div class="header-wrapper"><h4 id="x3-7-2-variables-setup"><bdi class="secno">3.7.2 </bdi>Variables setup</h4><a class="self-link" href="#variables-setup-7" aria-label="Permalink for Section 3.7.2"></a></div>
				<ol class="condition">
					<li><b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.</li>
					<li><b>LET</b> <var>eaa_exception_disproportionate_burden</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="a11y:<i>exemption</i>" and normalize-space()="<i>eaa-disproportionate-burden</i>"]</code>.</li>
					<li><b>LET</b> <var>eaa_exception_fundamental_modification</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="a11y:<i>exemption</i>" and normalize-space()="<i>eaa-fundamental-alteration</i>"]</code>.</li>
					<li><b>LET</b> <var>eaa_exemption_micro_enterprises</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="a11y:<i>exemption</i>" and normalize-space()="<i>eaa-microenterprise</i>"]</code>.</li>

				</ol>
				</section><section id="instructions-7"><div class="header-wrapper"><h4 id="legal-considerations-instructions"><bdi class="secno">3.7.3 </bdi>Instructions</h4><a class="self-link" href="#legal-considerations-instructions" aria-label="Permalink for Section 3.7.3"></a></div>
				<ol class="condition">
					<li>
						<span><b>IF</b> <var>eaa_exemption_micro_enterprises</var> <b>OR</b> <var>eaa_exception_disproportionate_burden</var> <b>OR</b> <var>eaa_exception_fundamental_modification</var>:</span>
						<span><b>THEN</b> display <code id="legal-considerations-exempt">"Claims an accessibility exemption in some jurisdictions"</code><span class="str-id">[ID: legal-considerations-exempt]</span>.</span>
					</li>
					<li>
						<b>ELSE</b> either omit this display field if metadata is missing or display <code id="legal-considerations-no-metadata">"No information is available"</code><span class="str-id">[ID: legal-considerations-no-metadata]</span>.
					</li>
				</ol>
			</section></section>


			<section id="additional-accessibility-information"><div class="header-wrapper"><h3 id="x3-8-additional-accessibility-information"><bdi class="secno">3.8 </bdi>Additional accessibility information</h3><a class="self-link" href="#additional-accessibility-information" aria-label="Permalink for Section 3.8"></a></div>
				
				<p>This technique relates to the <a href="../../guidelines/#additional-accessibility-information">Additional accessibility information accessibility display field</a>.</p>

				<p>This algorithm takes the <var>package_document_as_text</var> argument: a UTF-8 string representing the Package document.</p>

                    <section id="understanding-the-variables-8"><div class="header-wrapper"><h4 id="x3-8-1-understanding-the-variables"><bdi class="secno">3.8.1 </bdi>Understanding the variables</h4><a class="self-link" href="#understanding-the-variables-8" aria-label="Permalink for Section 3.8.1"></a></div>
					<dl>
						<dt><var>aria</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="aria"</i>  (ARIA roles - semantic markup) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that the use of ARIA, including <a href="https://w3c.github.io/dpub-aria/">DPUB ARIA</a> is used to improve the semantic markup of the publication.</p>
						</dd>
                        
						<dt><var>audio_descriptions</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="audioDescriptions"</i> (Audio Descriptions) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that there is an audio descriptions track available for video content.</p>
						</dd>
                        
						<dt><var>braille</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="braille"</i> (Braille) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that there is braille available within the publication.</p>
						</dd>

                        <dt><var>full_ruby_annotations</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="fullRubyAnnotations"</i> (Full Ruby Annotations) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that ruby annotations are attached to every CJK ideographic character in the content. Ruby annotations are used as pronunciation guides for the logographic characters for languages like Chinese or Japanese. They make difficult CJK ideographic characters more accessible.</p>
						</dd>
						<dt><var>high_contrast_between_foreground_and_background_audio</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="highContrastAudio"</i> (Use of high contrast between foreground and background audio) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that foreground audio content (eg voice) is presented with no or low background noise (eg ambient sounds, music), at least 20dB below the level of the foreground, or background noise can be switched off (eg via an alternative audio track). Brief and occasional sound effects may be as loud as foreground voice so long as they are isolated from the foreground.</p>
						</dd>
                        
                        <dt><var>high_contrast_between_text_and_background</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="highContrastDisplay"</i> (Use of high contrast between text and background color) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that body text is presented with a contrast ratio of at least 4.5:1 (or 3:1 for large/heading text).</p>
						</dd>
                        
						<dt><var>large_print</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="largePrint"</i> (Large Print) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that the e-publication has been formatted to meet large print guidelines.</p>
						</dd>
                        
                        <dt><var>page_break_markers</var></dt>
                        <dd>
                            <p>If true it indicates that the <i>accessibilityFeature="pageBreakMarkers"</i> (Print-equivalent page numbering) is present in the package document, otherwise if false it means that the metadata is not present.</p>
                            <p>This means that the publication contains references to the page numbering.</p>
                        </dd>

						<dt><var>ruby_annotations</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="rubyAnnotations"</i> (Ruby Annotations) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that ruby annotations are attached to some but not all CJK ideographic characters in the content.</p>
						</dd>
                        
						<dt><var>sign_language</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="signLanguage"</i> (Sign language interpretation) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that a full signing of audio content of the product is supplied with the video file.</p>
						</dd>


						<dt><var>tactile_graphic</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="tactileGraphic"</i> (tactile 2D graphic) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that there is tactile graphic(s) contained within this publication.</p>
						</dd>
                        
						<dt><var>tactile_object</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="tactileObject"</i> (tactile 3D object) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that there is tactile 3D object(s) contained within this publication.</p>
						</dd>

 						<dt><var>text_to_speech_hinting</var></dt>
						<dd>
							<p>If true it indicates that the <i>accessibilityFeature="ttsMarkup"</i>  (Text-to-speech markup provided) is present in the package document, otherwise if false it means that the metadata is not present.</p>
							<p>This means that text-to-speech has been optimized through provision of PLS lexicons, SSML or CSS Speech synthesis hints or other speech synthesis markup languages or hinting.</p>
						</dd>
                        
 					</dl>

					</section><section id="variables-setup-8"><div class="header-wrapper"><h4 id="x3-8-2-variables-setup"><bdi class="secno">3.8.2 </bdi>Variables setup</h4><a class="self-link" href="#variables-setup-8" aria-label="Permalink for Section 3.8.2"></a></div>
					<ol class="condition">
                        <li><b>LET</b> <var>package_document</var> be the result of calling <a href="#pre-processing">preprocessing</a> given <var>package_document_as_text</var>.</li>
                        
						<li><b>LET</b> <var>aria</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>aria</i>"]</code>.</li>
                        
						<li><b>LET</b> <var>audio_descriptions</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>audioDescription</i>"]</code>.</li>
						
                        <li><b>LET</b> <var>braille</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>braille</i>"]</code>.</li>

						<li><b>LET</b> <var>full_ruby_annotations</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>fullRubyAnnotations</i>"]</code>.</li>
                        
    				    <li><b>LET</b> <var>high_contrast_between_foreground_and_background_audio</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>highContrastAudio</i>"]</code>.</li>
                        
    				    <li><b>LET</b> <var>high_contrast_between_text_and_background</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>highContrastDisplay</i>"]</code>.</li>
                        
                        <li><b>LET</b> <var>large_print</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>largePrint</i>"]</code>.</li>
                        
                        <li><b>LET</b> <var>page_break_markers</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>pageBreakMarkers</i>"]</code>.</li>
                        
						<li><b>LET</b> <var>ruby_annotations</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>rubyAnnotations</i>"]</code>.</li>
                        
                        <li><b>LET</b> <var>sign_language</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>signLanguage</i>"]</code>.</li>

                       <li><b>LET</b> <var>tactile_graphic</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>tactileGraphic</i>"]</code>.</li>
                        
                        <li><b>LET</b> <var>tactile_object</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>tactileObject</i>"]</code>.</li>
                        
 						<li><b>LET</b> <var>text_to_speech_hinting</var> be the result of calling <a href="#check-for-node">check for node</a> on <var>package_document</var>, <code class="xpath">/package/metadata/meta[@property="schema:<i>accessibilityFeature</i>" and normalize-space()="<i>ttsMarkup</i>"]</code>.</li>
    				</ol>
                        
					</section><section id="instructions-8"><div class="header-wrapper"><h4 id="additional-accessibility-information-instructions"><bdi class="secno">3.8.3 </bdi>Instructions</h4><a class="self-link" href="#additional-accessibility-information-instructions" aria-label="Permalink for Section 3.8.3"></a></div>
					<ol class="condition">
                        <li>
                            <span><b>IF</b> <var>page_break_markers</var>:</span>
                        	<span><b>THEN</b> display <code id="additional-accessibility-information-page-breaks">"Page breaks included"</code><span class="str-id">[ID: additional-accessibility-information-page-breaks]</span>.</span>
                        </li>
						<li>
							<span><b>IF</b> <var>aria</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-aria">"ARIA roles included"</code><span class="str-id">[ID: additional-accessibility-information-aria]</span>.</span>
						</li>
						<li>
							<span><b>IF</b> <var>audio_descriptions</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-audio-descriptions">"Audio descriptions"</code><span class="str-id">[ID: additional-accessibility-information-audio-descriptions]</span>.</span></li>
						<li>
							<span><b>IF</b> <var>braille</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-braille">"Braille"</code><span class="str-id">[ID: additional-accessibility-information-braille]</span>.</span>
						</li>
						<li>
							<span><b>IF</b> <var>full_ruby_annotations</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-full-ruby-annotations">"Full ruby annotations"</code><span class="str-id">[ID: additional-accessibility-information-full-ruby-annotations]</span>.</span>
						</li>
						<li>
							<span><b>IF</b> <var>high_contrast_between_foreground_and_background_audio</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-high-contrast-between-foreground-and-background-audio">"High contrast between foreground and background audio"</code><span class="str-id">[ID: additional-accessibility-information-high-contrast-between-foreground-and-background-audio]</span> .</span>
						</li>
						<li>
							<span><b>IF</b> <var>high_contrast_between_text_and_background</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-high-contrast-between-text-and-background">"High contrast between foreground text and background"</code><span class="str-id">[ID: additional-accessibility-information-high-contrast-between-text-and-background]</span>.</span>
						</li>
						<li>
							<span><b>IF</b> <var>large_print</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-large-print">"Large print"</code><span class="str-id">[ID: additional-accessibility-information-large-print]</span>.</span>
						</li>
						<li>
							<span><b>IF</b> <var>ruby_annotations</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-ruby-annotations">"Some Ruby annotations"</code><span class="str-id">[ID: additional-accessibility-information-ruby-annotations]</span>.</span>
                        </li>
						<li>
							<span><b>IF</b> <var>sign_language</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-sign-language">"Sign language"</code><span class="str-id">[ID: additional-accessibility-information-sign-language]</span>.</span>
						</li>
						<li>
							<span><b>IF</b> <var>tactile_graphic</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-tactile-graphics">"Tactile graphics included"</code><span class="str-id">[ID: additional-accessibility-information-tactile-graphics]</span>.</span>
						</li>
						<li>
							<span><b>IF</b> <var>tactile_object</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-tactile-objects">"Tactile 3D objects"</code><span class="str-id">[ID: additional-accessibility-information-tactile-objects]</span>.</span>
						</li>
						<li>
							<span><b>IF</b> <var>text_to_speech_hinting</var>:</span>
							<span><b>THEN</b> display <code id="additional-accessibility-information-text-to-speech-hinting">"Text-to-speech hinting provided"</code><span class="str-id">[ID: additional-accessibility-information-text-to-speech-hinting]</span>.</span>
						</li>
					</ol>
			</section></section>

		</section>
		<section id="app-acknowledgements" class="appendix informative"><div class="header-wrapper"><h2 id="acknowledgements"><bdi class="secno">A. </bdi>Acknowledgements</h2><a class="self-link" href="#acknowledgements" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
	
	
	<p>The leadership and editing contributions of the following individuals were central to producing this guide:</p>
	
	<ul>
		<li>Avneesh Singh</li>
		<li>Charles LaPierre</li>
		<li>Chris Saynor</li>
		<li>Gautier Chomel</li>
		<li>George Kerscher</li>
		<li>Gregorio Pellegrino</li>
		<li>Madeleine Rothberg</li>
		<li>Matt Garrish</li>
	</ul>
	
	<p>The following members of the Publishing Community Group contributed to the development of this document:</p>
	
	<ul>
		<li>Chris Oliver</li>
		<li>Christopher Carr</li>
		<li>Hadrien Gardeur</li>
		<li>James Yanchak</li>
		<li>Jason White</li>
		<li>Jonas Lillqvist</li>
		<li>Miia Kirsi</li>
		<li>Naomi Kennedy</li>
		<li>Rick Johnson</li>
		<li>Simon Mellins</li>
	</ul>
</section>
	
	
<section id="references" class="appendix"><div class="header-wrapper"><h2 id="b-references"><bdi class="secno">B. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix B."></a></div><section id="informative-references"><div class="header-wrapper"><h3 id="b-1-informative-references"><bdi class="secno">B.1 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix B.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-epub-33">[EPUB-33]</dt><dd>
      <a href="https://www.w3.org/TR/epub-33/"><cite>EPUB 3.3</cite></a>. Ivan Herman; Matt Garrish; Dave Cramer.  W3C. 7 January 2025. W3C Recommendation. URL: <a href="https://www.w3.org/TR/epub-33/">https://www.w3.org/TR/epub-33/</a>
    </dd><dt id="bib-epub-a11y-11">[epub-a11y-11]</dt><dd>
      <a href="https://www.w3.org/TR/epub-a11y-11/"><cite>EPUB Accessibility 1.1</cite></a>. George Kerscher; Matt Garrish; Charles LaPierre; Avneesh Singh; Gregorio Pellegrino.  W3C. 17 October 2024. W3C Recommendation. URL: <a href="https://www.w3.org/TR/epub-a11y-11/">https://www.w3.org/TR/epub-a11y-11/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>